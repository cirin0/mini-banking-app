# üè¶ –ú—ñ–Ω—ñ–±–∞–Ω–∫—ñ–Ω–≥: —Ä–∞—Ö—É–Ω–∫–∏ —Ç–∞ –ø–µ—Ä–µ–∫–∞–∑–∏ (Proxy Pattern)

## üìã –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É

–ú–µ—Ç–∞ –ø—Ä–æ—î–∫—Ç—É ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º—ñ–Ω—ñ–±–∞–Ω–∫—ñ–Ω–≥-—Å–µ—Ä–≤—ñ—Å, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º:

- —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –±–∞–Ω–∫—ñ–≤—Å—å–∫—ñ —Ä–∞—Ö—É–Ω–∫–∏;
- –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –±–∞–ª–∞–Ω—Å;
- –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –ø–µ—Ä–µ–∫–∞–∑–∏ –º—ñ–∂ —Ä–∞—Ö—É–Ω–∫–∞–º–∏;
- –≤–µ—Å—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é –æ–ø–µ—Ä–∞—Ü—ñ–π;
- –∫–µ—Ä—É–≤–∞—Ç–∏ –ø–ª–∞—Ç—ñ–∂–Ω–∏–º–∏ –∫–∞—Ä—Ç–∫–∞–º–∏ (—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, –ø–æ—à—É–∫ –∑–∞ –Ω–æ–º–µ—Ä–æ–º/—Ä–∞—Ö—É–Ω–∫–æ–º/–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º);
- –ø—Ä–æ—Ö–æ–¥–∏—Ç–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é —Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é —á–µ—Ä–µ–∑ JWT (access + refresh —Ç–æ–∫–µ–Ω–∏).

–î–æ–¥–∞—Ç–∫–æ–≤–æ —Ä–µ–∞–ª—ñ–∑—É—î—Ç—å—Å—è **–ø–∞—Ç–µ—Ä–Ω Proxy** –¥–ª—è:

- –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –¥–æ –±–∞–Ω–∫—ñ–≤—Å—å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π;
- –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤;
- —ñ–º—ñ—Ç–∞—Ü—ñ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–Ω–∫—ñ–≤—Å—å–∫–æ–≥–æ API –±–µ–∑ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É.

---

## üß© –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –≤–∏–º–æ–≥–∏

### 1. –û–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

- –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (email, –ø–∞—Ä–æ–ª—å);
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ JWT (login/logout/refresh), refresh-—Ç–æ–∫–µ–Ω –≤–∏–¥–∞—î—Ç—å—Å—è –≤ httpOnly cookie;
- –ü–µ—Ä–µ–≥–ª—è–¥ –ø—Ä–æ—Ñ—ñ–ª—é –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (JWT).

### 2. –ë–∞–Ω–∫—ñ–≤—Å—å–∫—ñ —Ä–∞—Ö—É–Ω–∫–∏

- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–∞—Ö—É–Ω–∫—É (—Ç–∏–ø: –ø–æ—Ç–æ—á–Ω–∏–π, –¥–µ–ø–æ–∑–∏—Ç–Ω–∏–π);
- –ü–µ—Ä–µ–≥–ª—è–¥ —Å–ø–∏—Å–∫—É —Ä–∞—Ö—É–Ω–∫—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞;
- –ü–µ—Ä–µ–≥–ª—è–¥ –±–∞–ª–∞–Ω—Å—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞—Ö—É–Ω–∫—É;
- –ü–æ–ø–æ–≤–Ω–µ–Ω–Ω—è —Ä–∞—Ö—É–Ω–∫—É (deposit) –∑ –±–∞–∑–æ–≤–æ—é –≤–∞–ª—ñ–¥–∞—Ü—ñ—î—é –¥–æ—Å—Ç—É–ø—É.

### 3. –ü–µ—Ä–µ–∫–∞–∑–∏

- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–µ—Ä–µ–∫–∞–∑—É –º—ñ–∂ —Ä–∞—Ö—É–Ω–∫–∞–º–∏;
- –ü–µ—Ä–µ–∫–∞–∑ –∑–∞ –Ω–æ–º–µ—Ä–æ–º –∫–∞—Ä—Ç–∫–∏/—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–æ–º (–∑ –≤–∞–ª—ñ–¥–∞—Ü—ñ—î—é –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç–∫–∏);
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∫–æ—à—Ç—ñ–≤;
- –Ü—Å—Ç–æ—Ä—ñ—è –ø–µ—Ä–µ–∫–∞–∑—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –∑–∞ –∫–∞—Ä—Ç–∫–æ—é.

### 4. –ü–ª–∞—Ç—ñ–∂–Ω—ñ –∫–∞—Ä—Ç–∫–∏

- –í–∏–ø—É—Å–∫ –∫–∞—Ä—Ç–∫–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞—Ö—É–Ω–∫—É (–≤–∫–∞–∑–∞–Ω–Ω—è —Ç–∏–ø—É –∫–∞—Ä—Ç–∫–∏ —Ç–∞ –ø–ª–∞—Ç—ñ–∂–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏);
- –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–∞—Ä—Ç–∫–∏ –∑–∞ ID –∞–±–æ –Ω–æ–º–µ—Ä–æ–º;
- –ü–µ—Ä–µ–≥–ª—è–¥ –∫–∞—Ä—Ç–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –∫–∞—Ä—Ç–æ–∫, –ø—Ä–∏–≤'—è–∑–∞–Ω–∏—Ö –¥–æ —Ä–∞—Ö—É–Ω–∫—É.

### 5. Proxy Layer

- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ Proxy Pattern –¥–ª—è –≤—Å—ñ—Ö –æ—Å–Ω–æ–≤–Ω–∏—Ö –º–æ–¥—É–ª—ñ–≤:
  - **TransactionsRepositoryProxy** - –ª–æ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –æ–ø–µ—Ä–∞—Ü—ñ–π –∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º–∏
  - **TransactionsServiceProxy** - –≤–∞–ª—ñ–¥–∞—Ü—ñ—è —Å—É–º, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É, –ª–æ–≥—É–≤–∞–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
  - **AccountsRepositoryProxy** - –ª–æ–≥—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π –∑ —Ä–∞—Ö—É–Ω–∫–∞–º–∏, –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–µ–ø–æ–∑–∏—Ç—ñ–≤, –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –±–∞–ª–∞–Ω—Å—ñ–≤
  - **AccountsServiceProxy** - –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –ª—ñ–º—ñ—Ç—ñ–≤ —Ä–∞—Ö—É–Ω–∫—ñ–≤, –ª–æ–≥—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π –¥–µ–ø–æ–∑–∏—Ç—É
  - **CardsRepositoryProxy** - –ª–æ–≥—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π –∑ –∫–∞—Ä—Ç–∫–∞–º–∏, –±–µ–∑–ø–µ–∫–∞ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø—ñ –¥–æ CVV
  - **CardsServiceProxy** - –¥–æ–¥–∞—Ç–∫–æ–≤–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è, –ª–æ–≥—É–≤–∞–Ω–Ω—è —Å–ø—Ä–æ–± –¥–æ—Å—Ç—É–ø—É –¥–æ —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö

#### –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å Proxy:

- **–õ–æ–≥—É–≤–∞–Ω–Ω—è**: –°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –ª–æ–≥–∏ –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (userId, timestamp, duration, success/error)
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è**: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –ø–µ—Ä–µ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º –æ–ø–µ—Ä–∞—Ü—ñ–π (—Å—É–º–∏, ID, –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É)
- **–ë–µ–∑–ø–µ–∫–∞**: –õ–æ–≥—É–≤–∞–Ω–Ω—è —Å–ø—Ä–æ–± –¥–æ—Å—Ç—É–ø—É –¥–æ —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö (CVV), –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥**: –ó–±—ñ—Ä –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ (—á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü—ñ–π, –ø–æ–º–∏–ª–∫–∏)

---

## ‚öôÔ∏è –¢–µ—Ö–Ω—ñ—á–Ω—ñ –≤–∏–º–æ–≥–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                  | –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è / –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç             |
| -------------------------- | ----------------------------------- |
| Back-end framework         | NestJS (v11)                        |
| –ú–æ–≤–∞                       | TypeScript (v5)                     |
| –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö                 | PostgreSQL + Prisma                 |
| –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞                | Modular + Proxy Pattern             |
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è/–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è | Passport + JWT (access/refresh)     |
| –í–∞–ª—ñ–¥–∞—Ü—ñ—è DTO              | class-validator / class-transformer |
| –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è                 | Jest                                |
| API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è           | Swagger (OpenAPI)                   |
| –õ—ñ–Ω—Ç–∏–Ω–≥/–§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è       | ESLint + Prettier                   |

---

## üë• –†–æ–∑–ø–æ–¥—ñ–ª —Ä–æ–ª–µ–π

| –£—á–∞—Å–Ω–∏–∫                             | –í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å                                                                                                                                                                                                |
| ----------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **–£—á–∞—Å–Ω–∏–∫ 1 (Backend Core)**        | - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è NestJS –ø—Ä–æ—î–∫—Ç—É;<br>- –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–æ–¥—É–ª—ñ–≤: `Auth`, `User`, `Account`;<br>- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ë–î (PostgreSQL + Prisma);<br>- JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è;<br>- Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è.                                  |
| **–£—á–∞—Å–Ω–∏–∫ 2 (Proxy & Transaction)** | - –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–∞—Ç–µ—Ä–Ω—É Proxy;<br>- –ú–æ–¥—É–ª—å `Card`, `Transaction` (—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, —ñ—Å—Ç–æ—Ä—ñ—è, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–∞—Ä—Ç);<br>- –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π;<br>- –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è Proxy-—à–∞—Ä—É;<br>- Middleware –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó. |

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ—î–∫—Ç—É

1) –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

```bash
npm install
```

2) –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ `.env` (–ø—Ä–∏–∫–ª–∞–¥):

```env
DATABASE_URL=postgresql://user:password@localhost:5432/minibanking

PORT=3000
NODE_ENV=development
API_PREFIX=api

JWT_TOKEN_SECRET=supersecretkey
JWT_REFRESH_TOKEN_SECRET=anothersecretkey
```

3) –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ë–î (Prisma)

```bash
npx prisma migrate dev --name init
npx prisma generate
```

4) –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫

```bash
npm run start:dev
```

- Swagger: http://localhost:3000/api/docs
- API –ø—Ä–µ—Ñ—ñ–∫—Å: `/${API_PREFIX}` (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º `/api`)
